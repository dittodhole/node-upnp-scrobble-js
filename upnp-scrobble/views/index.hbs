<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="utf-8" />
  <title></title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/normalize/3.0.3/normalize.css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/milligram/1.0.3/milligram.min.css" />
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.1/moment-with-locales.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/moment-duration-format/1.3.0/moment-duration-format.min.js"></script>
  <style type="text/css">
    progress {
      -webkit-appearance: none;
    }

      progress::-webkit-progress-bar {
        background-color: #f4f5f6;
      }
      progress::-webkit-progress-value{
        -webkit-transition: 1s linear;
      }
  </style>
</head>
<body class="container">
  {{#each peer.remoteDevices}}
  <div class="row">
    <div class="column">
      <img src="{{this.icons.0.url}}" />
    </div>
    <div class="column">
      <strong>{{this.friendlyName}}</strong><br />
      {{this.modelName}}
    </div>
    {{#if this.song}}
    <div class="column"
         style="text-align: right;">
      <img src="{{this.song.albumArtURI}}" />
    </div>
  </div>
  <div class="row">
    <div class="column"
         style="text-align: right;">
      <strong>{{this.song.track}}</strong><br />
      {{this.song.artist}}<br />
      <small>{{this.song.album}}</small>
    </div>
  </div>
  <script type="text/javascript">
    window.setInterval(function () {
      var position = (Date.now() - {{this.song.timestamp}}) / 1000 + {{this.song.positionInSeconds}};

      var progress = document.getElementById('{{this.UDN}}-progress');
      progress.value = position;

      var trackPosition = document.getElementById('{{this.UDN}}-trackPosition');
      trackPosition.textContent = moment.duration(position, 'seconds').format('hh:mm:ss', {
        "forceLength": true,
        "trim": false
      });
    }, 1 * 1000);
    window.setTimeout(function () {
      var trackPosition = document.getElementById('{{this.UDN}}-trackPosition');
      trackPosition.textContent = moment.duration({{this.song.positionInSeconds}}, 'seconds').format('hh:mm:ss', {
        "forceLength": true,
        "trim": false
      });
      var trackDuration = document.getElementById('{{this.UDN}}-trackDuration');
      trackDuration.textContent = moment.duration({{this.song.positionInSeconds}}, 'seconds').format('hh:mm:ss', {
        "forceLength": true,
        "trim": false
      });
    }, 0);
  </script>
  <div class="row">
    <div class="column">
      <progress id="{{this.UDN}}-progress"
                value="{{this.song.positionInSeconds}}"
                max="{{this.song.durationInSeconds}}"
                style="width: 100%;" />
    </div>
  </div>
  <div class="row">
    <div class="column"
         style="text-align: left">
      <span id="{{this.UDN}}-trackPosition" />
    </div>
    <div class="column"
         style="text-align: right;">
      <span id="{{this.UDN}}-trackDuration" />
    </div>
    {{/if}}
  </div>
  <!--
  {{#each this.services}}
  {{#each this.eventQueue._store}}
  <h3>{{this.timestamp}}</h3>
  {{#if this.event}}
  <div class="row">
    <div class="column">
      <pre><code>{{formatXML this.event}}</code></pre>
    </div>
  </div>
  {{/if}}
  {{#if this.change}}
  <div class="row">
    <div class="column">
      <pre><code>{{formatXML this.change}}</code></pre>
    </div>
  </div>
  {{/if}}
  {{#if this.metadata}}
  <div class="row">
    <div class="column">
      <pre><code>{{formatXML this.metadata}}</code></pre>
    </div>
  </div>
  {{/if}}
  {{/each}}
  {{/each}}
  -->
  {{/each}}
</body>
</html>